Поиск медиан

 Медиана — элемент массива, который находился бы в этом массиве после сортировки на среднем месте. При нумерации элементов массива размером N с единицы, номер медианного элемента вычисляется по выражению (N+1)/2.
 Известно, что имеются алгоритмы поиск медианы в массиве с линейной сложностью. Вам предстоит решать эту задачу много раз, поэтому стоило бы уменьшить сложность этой операции.
 
 Input format
 Первая строка файла содержит число запросов 5 ⩽ N ⩽ 1000000
 Запросы могут быть трёх типов:
 0 X — добавить число X в массив. В массиве может быть произвольное число одинаковых элементов.
 1 X — удалить число X из массива. Удаление несуществующего элемента эквивалентно пустой операции.
 2 — вывести медиану массива.
 Числа X по абсолютной величине не превосходят 109.
 
 Output format
 По одной строке на каждый запрос типа 2.
 
 Examples
 
 Input
 19
 0 1
 0 2
 2
 0 3
 2
 0 4
 2
 0 5
 2
 0 6
 2
 0 7
 2
 1 3
 2
 1 2
 2
 1 2
 2
 Output
 1
 2
 2
 3
 3
 4
 4
 5
 5
